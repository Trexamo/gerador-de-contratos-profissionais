<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ContratoF√°cil - Contratos Profissionais em 5 Minutos</title>
    <link rel="icon" href="logo.jpg" type="image/jpeg">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Sign-In -->
    <meta name="google-signin-client_id" content="395303260900-usl0idov344ud7qo9ptr82mnmqfidebd.apps.googleusercontent.com">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <!-- EmailJS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function(){
            emailjs.init("y2Y2FotVDMytchPMg");
        })();
    </script>
</head>
<body>
    <!-- Status Bar -->
    <div class="status-bar" id="statusBar" style="display: none;">
        <div class="container">
            <div class="status-content">
                <div class="status-info">
                    <i class="fas fa-crown" id="statusIcon"></i>
                    <span id="statusText">Plano Gratuito - Visualiza√ß√µes Ilimitadas</span>
                </div>
                <div class="status-actions">
                    <span id="statusCount">Contratos visualizados: <strong>0</strong></span>
                    <button class="btn-upgrade" onclick="openPaymentModal('profissional')">
                        <i class="fas fa-rocket"></i> Fazer Upgrade
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <img src="logo.jpg" alt="ContratoF√°cil" class="logo-img">
                    <span>ContratoF√°cil</span>
                </div>
                <nav class="nav-menu">
                    <ul>
                        <li><a href="#home">In√≠cio</a></li>
                        <li><a href="#generator">Criar Contrato</a></li>
                        <li><a href="planos.html">Planos</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="politica-de-privacidade.html">Pol√≠tica de Privacidade</a></li>
                        <li><a href="termos-de-uso.html">Termos de Uso</a></li>
                        <!-- √Årea do usu√°rio (aparece quando logado) -->
                        <li id="userNav" style="display: none;">
                            <a href="user.html" class="user-menu">
                                <i class="fas fa-user"></i>
                                <span id="userNameNav"></span>
                            </a>
                        </li>
                    </ul>
                </nav>
                <div class="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                
                <!-- Bot√£o de login/usu√°rio -->
                <div id="loginButton" class="mobile-hidden">
                    <button class="btn-login" onclick="showLoginModal()">
                        <i class="fas fa-sign-in-alt"></i> Entrar
                    </button>
                </div>
                
                <div id="userButton" class="mobile-hidden" style="display: none;">
                    <a href="user.html" class="btn-login">
                        <i class="fas fa-user"></i> Minha Conta
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Se√ß√£o Hero Melhorada -->
    <section class="hero" id="home">
        <div class="container">
            <div class="hero-content">
                <h1>
                    Contratos Profissionais em 
                    <span class="hero-highlight">5 Minutos</span>
                </h1>
                <p>
                    Crie contratos juridicamente v√°lidos com nosso gerador inteligente. 
                    <strong>Visualize gratuitamente</strong> e pague apenas quando baixar.
                </p>
                <div class="hero-buttons">
                    <button class="btn btn-large" onclick="scrollToGenerator()">
                        <i class="fas fa-bolt"></i> Criar Meu Contrato Seguro
                    </button>
                    <button class="btn btn-large btn-outline" onclick="showLoginModal()">
                        <i class="fas fa-eye"></i> Visualizar Gratuitamente
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Se√ß√£o do V√≠deo Persuasivo - Centralizada -->
    <section class="video-section" id="videoSection">
        <div class="container">
            <div class="video-container">
                <h2>‚ö†Ô∏è ATEN√á√ÉO: N√£o Assine Nenhum Contrato Sem Ver Isso!</h2>
                
                <div class="video-wrapper">
                    <video controls autoplay muted class="intro-video" poster="video-poster.jpg">
                        <source src="video.mp4" type="video/mp4">
                        Seu navegador n√£o suporta o elemento de v√≠deo.
                    </video>
                </div>
                

                    <div class="video-cta">
                        <button class="btn btn-large" onclick="scrollToGenerator()">
                            <i class="fas fa-shield-alt"></i> Criar Meu Contrato Seguro Agora
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Generator Section -->
    <section class="generator" id="generator">
        <div class="container">
            <div class="section-title">
                <h2>Crie Seu Contrato Agora</h2>
                <p>Preencha os dados abaixo e visualize em tempo real seu contrato profissional</p>
            </div>
            
            <!-- Aviso de login necess√°rio -->
            <div id="loginRequired" class="login-required" style="display: none;">
                <div class="login-required-content">
                    <i class="fas fa-lock"></i>
                    <h3>Login Necess√°rio</h3>
                    <p>Fa√ßa login para criar e visualizar contratos</p>
                    <button class="btn-login" onclick="showLoginModal()">
                        <i class="fas fa-sign-in-alt"></i> Fazer Login
                    </button>
                </div>
            </div>
            
            <div class="generator-container" id="generatorForm" style="display: none;">
                <!-- Form Section -->
                <div class="form-section">
                    <h3>Informa√ß√µes do Contrato</h3>
                    <div class="form-group">
                        <label for="contractorName">Nome do Contratante *</label>
                        <input type="text" id="contractorName" placeholder="Seu nome ou empresa">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contractorDoc">CPF/CNPJ do Contratante *</label>
                            <input type="text" id="contractorDoc" placeholder="CPF ou CNPJ">
                        </div>
                        <div class="form-group">
                            <label for="contractorProfession">Profiss√£o do Contratante</label>
                            <input type="text" id="contractorProfession" placeholder="Sua profiss√£o">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="contractorAddress">Endere√ßo do Contratante</label>
                        <input type="text" id="contractorAddress" placeholder="Endere√ßo completo">
                    </div>
                    
                    <div class="form-group">
                        <label for="contractedName">Nome do Contratado *</label>
                        <input type="text" id="contractedName" placeholder="Nome do prestador">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contractedDoc">CPF/CNPJ do Contratado *</label>
                            <input type="text" id="contractedDoc" placeholder="CPF ou CNPJ">
                        </div>
                        <div class="form-group">
                            <label for="contractedProfession">Profiss√£o do Contratado</label>
                            <input type="text" id="contractedProfession" placeholder="Profiss√£o do prestador">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="contractedAddress">Endere√ßo do Contratado</label>
                        <input type="text" id="contractedAddress" placeholder="Endere√ßo completo">
                    </div>
                    
                    <div class="form-group">
                        <label for="serviceDescription">Descri√ß√£o do Servi√ßo *</label>
                        <textarea id="serviceDescription" rows="4" placeholder="Descreva detalhadamente o servi√ßo a ser prestado"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="serviceValue">Valor do Servi√ßo (R$) *</label>
                            <input type="text" id="serviceValue" placeholder="0,00">
                        </div>
                        <div class="form-group">
                            <label for="paymentMethod">Forma de Pagamento</label>
                            <select id="paymentMethod">
                                <option value="transferencia">Transfer√™ncia Banc√°ria</option>
                                <option value="boleto">Boleto</option>
                                <option value="pix">PIX</option>
                                <option value="cartao">Cart√£o de Cr√©dito</option>
                                <option value="dinheiro">Dinheiro</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Campos de Estado Civil -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contractorCivilState">Estado Civil do Contratante</label>
                            <select id="contractorCivilState">
                                <option value="">Selecione</option>
                                <option value="solteiro(a)">Solteiro(a)</option>
                                <option value="casado(a)">Casado(a)</option>
                                <option value="divorciado(a)">Divorciado(a)</option>
                                <option value="vi√∫vo(a)">Vi√∫vo(a)</option>
                                <option value="uni√£o est√°vel">Uni√£o Est√°vel</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="contractedCivilState">Estado Civil do Contratado</label>
                            <select id="contractedCivilState">
                                <option value="">Selecione</option>
                                <option value="solteiro(a)">Solteiro(a)</option>
                                <option value="casado(a)">Casado(a)</option>
                                <option value="divorciado(a)">Divorciado(a)</option>
                                <option value="vi√∫vo(a)">Vi√∫vo(a)</option>
                                <option value="uni√£o est√°vel">Uni√£o Est√°vel</option>
                            </select>
                        </div>
                    </div>

<!-- Sistema de Assinatura - Contratado -->
<div class="signature-options">
    <h4>Assinatura do Contratado</h4>
    
    <div class="signature-option" onclick="selectSignatureOption('contracted', 'upload', event)">
        <strong>Anexar Assinatura</strong>
        <p>Fa√ßa upload de uma imagem da sua assinatura (fundo branco)</p>
        <input type="file" id="contractedSignatureUpload" accept="image/*" style="display: none;" onchange="handleSignatureUpload(event, 'contracted')">
        <!-- REMOVA ESTA LINHA: <canvas id="contractedSignatureCanvas"... -->
    </div>
    
    <div class="signature-option" onclick="selectSignatureOption('contracted', 'draw', event)">
        <strong>Desenhar Assinatura</strong>
        <p>Use o mouse ou touch para desenhar sua assinatura</p>
        <canvas id="contractedSignatureDraw" width="300" height="100" style="border: 1px solid #ccc; display: none;"></canvas>
    </div>
    
    <div class="signature-preview" id="contractedSignaturePreview">
        <p style="color: #666;">Assinatura aparecer√° aqui</p>
    </div>
    
    <div class="signature-actions" id="contractedSignatureConfirmation" style="display: none;">
        <button type="button" class="btn" onclick="clearSignature('contracted')">
            <i class="fas fa-redo"></i> Refazer
        </button>
        <button type="button" class="btn btn-success" onclick="confirmSignature('contracted')">
            <i class="fas fa-check"></i> Confirmar
        </button>
    </div>
</div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate">Data de In√≠cio *</label>
                            <input type="date" id="startDate">
                        </div>
                        <div class="form-group">
                            <label for="endDate">Data de T√©rmino</label>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="contractCity">Cidade de Vig√™ncia *</label>
                        <input type="text" id="contractCity" placeholder="Cidade onde o contrato √© v√°lido">
                    </div>
                    
                    <div class="actions">
                        <button class="btn" onclick="openSecurePreview()">
                            <i class="fas fa-eye"></i> Visualizar Gratuitamente
                        </button>
                        <button class="btn btn-success" onclick="generateWordPlus()">
                            <i class="fas fa-download"></i> Baixar Contrato - R$ 6,99
                        </button>
                    </div>
                </div>
                
                <!-- Preview Section -->
                <div class="preview-section">
                    <div class="preview-header">
                        <h3>Pr√©-visualiza√ß√£o do Seu Contrato</h3>
                        <p class="preview-notice">‚úÖ Visualiza√ß√£o gratuita - Fa√ßa upgrade para baixar</p>
                    </div>
                    <div class="contract-preview" id="contractPreview">
                        <!-- CONTRATO PROFISSIONAL SER√Å INSERIDO AQUI VIA JAVASCRIPT -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer com link de administra√ß√£o escondido -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>ContratoF√°cil</h3>
                    <p>Criando contratos profissionais de forma simples e segura desde 2024.</p>
                </div>
                <div class="footer-column">
                    <h3>Links R√°pidos</h3>
                    <ul>
                        <li><a href="#home">In√≠cio</a></li>
                        <li><a href="#generator">Criar Contrato</a></li>
                        <li><a href="planos.html">Planos</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Suporte</h3>
                    <ul>
                        <li><a href="#" onclick="showContactModal()">Contato</a></li>
                        <li><a href="politica-de-privacidade.html">Pol√≠tica de Privacidade</a></li>
                        <li><a href="termos-de-uso.html">Termos de Uso</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contato</h3>
                    <ul>
                        <li><a href="mailto:luhkaimn@gmail.com"><i class="fas fa-envelope"></i> luhkaimn@gmail.com</a></li>
                        <li><i class="fas fa-map-marker-alt"></i> Goi√¢nia, GO</li>
                        <!-- Link de administra√ß√£o escondido -->
                        <li style="opacity: 0.3; font-size: 0.7rem;">
                            <a href="admin.html" style="color: #666; text-decoration: none;">
                                <i class="fas fa-cog"></i> Administra√ß√£o
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 ContratoF√°cil. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Payment Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Finalizar Compra</h3>
                <button class="close-modal" onclick="closePaymentModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modalPlanDescription">Plano selecionado</p>
                <h4 id="modalPrice">Total: R$ 0,00</h4>
                
                <div class="payment-options">
                    <div class="payment-option" onclick="selectPayment(this, 'pix')">
                        <div class="payment-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <span>PIX</span>
                    </div>
                    <div class="payment-option" onclick="selectPayment(this, 'cartao')">
                        <div class="payment-icon">
                            <i class="fab fa-cc-visa"></i>
                        </div>
                        <span>Cart√£o</span>
                    </div>
                </div>

                <!-- Informa√ß√µes para PIX -->
                <div id="pixDetails" class="bank-details" style="display: none;">
                    <h4>Pagamento via PIX</h4>
                    <p>Valor: <strong id="pixValue">R$ 6,99</strong></p>
                    <div class="payment-action">
                        <a href="#" id="pixLink" class="btn btn-success" target="_blank">
                            <i class="fas fa-qrcode"></i> Pagar com PIX Agora
                        </a>
                    </div>
                    <p class="payment-note">
                        Voc√™ ser√° redirecionado para o Mercado Pago
                    </p>
                </div>

                <!-- Informa√ß√µes para Cart√£o -->
                <div id="cardDetails" class="bank-details" style="display: none;">
                    <h4>Pagamento com Cart√£o</h4>
                    <p>Valor: <strong id="cardValue">R$ 6,99</strong></p>
                    <div class="payment-action">
                        <a href="#" id="cardLink" class="btn btn-success" target="_blank">
                            <i class="fas fa-credit-card"></i> Pagar com Cart√£o
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Entrar no ContratoF√°cil</h3>
                <button class="close-modal" onclick="closeLoginModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="login-modal-content">
                    <h4>Entre com Google</h4>
                    <p>√â r√°pido, f√°cil e seguro</p>
                    
                    <div id="g_id_onload_modal"
                         data-client_id="395303260900-usl0idov344ud7qo9ptr82mnmqfidebd.apps.googleusercontent.com"
                         data-context="signin"
                         data-ux_mode="popup"
                         data-callback="handleGoogleSignIn"
                         data-auto_prompt="false">
                    </div>

                    <div class="g_id_signin"
                         data-type="standard"
                         data-shape="rectangular"
                         data-theme="filled_blue"
                         data-text="signin_with"
                         data-size="large"
                         data-logo_alignment="left"
                         data-width="300">
                    </div>
                    
                    <p class="login-terms">
                        Ao entrar, voc√™ concorda com nossos <a href="termos-de-uso.html">Termos de Servi√ßo</a> e <a href="politica-de-privacidade.html">Pol√≠tica de Privacidade</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Contato -->
    <div class="modal" id="contactModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Entre em Contato</h3>
                <button class="close-modal" onclick="closeContactModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="contactForm" onsubmit="submitContactForm(event)">
                    <div class="form-group">
                        <label for="contactName">Seu Nome *</label>
                        <input type="text" id="contactName" required>
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">Seu Email *</label>
                        <input type="email" id="contactEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="contactSubject">Assunto *</label>
                        <input type="text" id="contactSubject" required>
                    </div>
                    <div class="form-group">
                        <label for="contactMessage">Mensagem *</label>
                        <textarea id="contactMessage" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-paper-plane"></i> Enviar Mensagem
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="script.js"></script>
    
    <script>
        // Fun√ß√µes para a barra de status
        function updateStatusBar(user) {
            const statusBar = document.getElementById('statusBar');
            const statusIcon = document.getElementById('statusIcon');
            const statusText = document.getElementById('statusText');
            const statusCount = document.getElementById('statusCount');
            
            if (user) {
                statusBar.style.display = 'block';
                
                if (user.plan === 'free') {
                    statusIcon.className = 'fas fa-eye';
                    statusText.textContent = 'Plano Gratuito - Visualiza√ß√µes Ilimitadas';
                    statusCount.innerHTML = `Contratos visualizados: <strong>${user.contractsGenerated || 0}</strong>`;
                } else if (user.plan === 'basico') {
                    statusIcon.className = 'fas fa-crown';
                    statusText.textContent = 'Plano B√°sico - 5 contratos/m√™s';
                    const remaining = 5 - (user.contractsDownloaded || 0);
                    statusCount.innerHTML = `Contratos restantes: <strong>${remaining}</strong>`;
                } else {
                    statusIcon.className = 'fas fa-gem';
                    statusText.textContent = 'Plano Profissional - Ilimitado';
                    statusCount.innerHTML = `Contratos baixados: <strong>${user.contractsDownloaded || 0}</strong>`;
                }
            } else {
                statusBar.style.display = 'none';
            }
        }

        // Modal de contato
        function showContactModal() {
            document.getElementById('contactModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeContactModal() {
            document.getElementById('contactModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function submitContactForm(event) {
            event.preventDefault();
            
            const templateParams = {
                from_name: document.getElementById('contactName').value,
                from_email: document.getElementById('contactEmail').value,
                subject: document.getElementById('contactSubject').value,
                message: document.getElementById('contactMessage').value
            };

            emailjs.send('service_s6hcwoa', 'template_wx7bj1m', templateParams)
                .then(function(response) {
                    alert('Mensagem enviada com sucesso! Entraremos em contato em breve.');
                    closeContactModal();
                    document.getElementById('contactForm').reset();
                }, function(error) {
                    alert('Erro ao enviar mensagem. Tente novamente ou entre em contato via email.');
                });
        }

        // Atualizar barra de status quando usu√°rio fizer login
        const originalHandleGoogleSignIn = window.handleGoogleSignIn;
        window.handleGoogleSignIn = function(response) {
            originalHandleGoogleSignIn(response);
            setTimeout(() => {
                const user = JSON.parse(localStorage.getItem('currentUser'));
                if (user) {
                    updateStatusBar(user);
                }
            }, 1000);
        };

        // Inicializar barra de status
        document.addEventListener('DOMContentLoaded', function() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            updateStatusBar(user);
        });

        // Scroll para o gerador
        function scrollToGenerator() {
            document.getElementById('generator').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Fun√ß√£o para visualiza√ß√£o segura
        function openSecurePreview() {
            if (!canGenerateContract()) {
                return;
            }
            
            const validationErrors = validateContractData();
            if (validationErrors.length > 0) {
                showNotification(`‚ùå Corrija os seguintes campos: ${validationErrors.join(', ')}`);
                return;
            }
            
            try {
                const contractData = collectContractData();
                const contractId = 'contract_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                
                sessionStorage.setItem('secureContractData', JSON.stringify(contractData));
                sessionStorage.setItem('secureContractId', contractId);
                
                const secureWindow = window.open('view-contract.html', '_blank');
                
                if (secureWindow) {
                    showNotification('üëÅÔ∏è Visualiza√ß√£o segura aberta em nova aba');
                } else {
                    showNotification('‚ùå Permita pop-ups para visualiza√ß√£o segura');
                }
                
            } catch (error) {
                console.error('Erro ao abrir visualiza√ß√£o segura:', error);
                showNotification('‚ùå Erro ao abrir visualiza√ß√£o segura');
            }
        }
    </script>
</body>
</html>
